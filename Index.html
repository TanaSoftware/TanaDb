<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="utf-8" />
    <title></title>
    <link href="css/cal.css" rel="stylesheet" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <link href='https://use.fontawesome.com/releases/v5.0.6/css/all.css' rel='stylesheet'>

    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css' rel='stylesheet' />
    <link href="//cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/build/css/bootstrap-datetimepicker.css" rel="stylesheet">

    <link href="css/bootstrap-datepicker.min.css" rel="stylesheet" />
    <script src="js/cal.js"></script>
    <script src="js/moment.js"></script>
    <script src="js/jquery.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="js/selectize.js"></script>
    <script src="js/global.js"></script>
    <style>

        .tooltip-inner {
            background-color: #f00 !important;
        }





        .btn {
            background: #33a6cc;
            box-shadow: 1px;
            color: #ffffff;
        }



        @media only screen and (max-width: 760px) {

            input[type=checkbox] {
                /* Double-sized Checkboxes */
                -ms-transform: scale(1.5); /* IE */
                -moz-transform: scale(1.5); /* FF */
                -webkit-transform: scale(1.5); /* Safari and Chrome */
                -o-transform: scale(1.5); /* Opera */
                transform: scale(1.5);
                padding-left: 20px !important;
            }
        }



        .checkbox-inline {
            padding-left: 5px !important;
        }
    </style>

</head>

<body dir="rtl" id="page-top" data-spy="scroll" data-target=".navbar-fixed-top" class="top">

    <section id="Login">

        <div class="container">

            <div class="row">

                <div class="col-md-5 col-md-offset-2">

                    <div style="text-align:right;font-weight:bold;">כניסה: </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="emailLogin" type="email" placeholder="מייל" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="passwordLogin" type="password" placeholder="סיסמה" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group" style="text-align:right">

                        <label>זכור אותי</label>

                        <label>

                            <input type="checkbox">

                        </label>

                    </div>

                    <div class="form-group">

                        <div id="dvProgBar" style="text-align:center;display:none;"><img src="css/ProgressBlue.gif" /></div>

                        <button onClick="Login();" class="btn btn-blue">כניסה</button>

                    </div>

                </div>

            </div>

        </div>

    </section>

    <section id="RegisterCustomer">

        <div class="container">

            <div class="row">

                <div class="col-md-5 col-md-offset-2">

                    <div style="text-align:right;font-weight:bold;">רישום משתמש: </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="userCust" type="text" placeholder="שם משתמש" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class=& quot;form-group floating-label-form-group controls">

                            <input id="txtTelCust" type="text" placeholder="טלפון נייד" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="emailCustomer" type="email" placeholder="מייל" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="passwordCustomer" type="password" placeholder="סיסמה" class="form-control input-lg" />

                        </div>

                    </div>



                    <div class="form-group">

                        <div id="dvProgBar" style="text-align:center;display:none;"><img src="css/ProgressBlue.gif" /></div>

                        <div id="dvErrRegister"></div>

                        <button onClick="RegisterCustmer();" class="btn btn-blue">הרשמה</button>

                    </div>

                </div>

            </div>

        </div>

    </section>

    <section id="Register">

        <div class="container">

            <div class="row">

                <div class="col-md-5 col-md-offset-2">

                    <div style="text-align:right;font-weight:bold;">הרשמה של בעל העסק: </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="name" type="text" placeholder="שם" class="form-control input-lg" />

                        </div>

                    </div>



                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="password" type="password" placeholder="סיסמה" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="email" type="email" placeholder="מייל" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="txtTel" type="text" placeholder="טלפון" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="bizName" type="text" placeholder="שם עסק בעברית" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="bizNameEng" type="text" placeholder="שם עסק באנגלית" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="creditCard" type="text" placeholder="כרטיס אשראי" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <input id="address" type="text" placeholder="כתובת" class="form-control input-lg" />

                        </div>

                    </div>

                    <div class="form-group">

                        <div class="form-group floating-label-form-group controls">

                            <select id="city" type="text" placeholder="כתובת" class="form-control input-lg">

                                <option value="0">בחר עיר</option>

                                <option value="6600">חולון</option>

                                <option value="5000">תל אביב</option>

                            </select>

                        </div>

                    </div>

                    <div style="text-align:right">
                        <label>סוגי פעילויות</label><span style="color:red" id="spnActiveDays"></span>

                        <div class="row" style="width:100%" id="UserActivities"></div>

                        <div class="form-group" style="width:100%;padding-bottom:10px;padding-top:10px;">

                            <input style="float:right;width:220px;margin-bottom:10px;" maxlength="50" id="BizType" type="text" placeholder="הזן סוג פעילות" class="form-control input-lg" />
                            <select id="ddlDuration" style="float:right;width:150px;" placeholder="" class="form-control">

                                <option value="0">משך פעילות</option>

                                <option>10</option>

                                <option>20</option>

                                <option>30</option>

                                <option>40</option>

                                <option>50</option>

                                <option>60</option>

                            </select>
                            <button onclick="AddUserActivity();" class="form-control" style="float:right;width:80px;margin-right:5px;">הוסף</button>

                        </div>
                        <div style="width:100%;padding-top:5px;float:right">
                            <label>ימי פעילות עובד</label><span style="color:red" id="spnActiveDays"></span>
                        </div>

                        <div class="row" style="width:100%" id="Activities"></div>

                        <div style="width:100%;padding-bottom:10px;padding-top:10px;">

                            <input style="float:right;width:220px;margin-bottom:10px;" maxlength="50" id="EmployeeId" type="text" placeholder="הזן שם עובד" class="form-control input-lg" />

                            <button onclick="AddActivity();" class="form-control" style="float:right;width:80px;margin-right:5px;">הוסף</button>

                        </div>

                        <table class="table table-striped table-bordered">

                            <tr>

                                <td>יום</td>

                                <td>שעות פעילות</td>

                                <td>

                                    <label>

                                        <input type="checkbox" onclick="EnableNoneActiveHours(this)" id="NoneHours"> שעות שאינן פעילות

                                    </label>

                                </td>                                

                            </tr>

                            <tr>

                                <td style="width:100px;">

                                    <input type="checkbox" checked="checked" id="Day1"> א

                                </td>



                                <td>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txtfromHour1" data-toggle="tooltip" trigger="manual" data-placement="top" style="width:65px;" type="text" value="08:00" placeholder="משעה" class="form-control input-lg" />

                                    </div>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txttoHour1" style="width:65px;" type="text" value="17:00" class="form-control input-lg" />

                                    </div>

                                </td>

                                <td>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txtfromHourNone1" style="width:65px;" type="text" value="13:00" placeholder="משעה" class="form-control input-lg" />

                                    </div>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txttoHourNone1" style="width:65px;" type="text" value="14:00" placeholder="עד שעה" class="form-control input-lg" />

                                    </div>

                                </td>
                               

                            </tr>

                            <tr>

                                <td style="width:100px;">

                                    <input type="checkbox" checked="checked" id="Day2"> ב

                                </td>

                                <td>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txtfromHour2" style="width:65px;" type="text" value="08:00" placeholder="משעה" class="form-control input-lg" />

                                    </div>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txttoHour2" style="width:65px;" type="text" value="17:00" placeholder="עד שעה" class="form-control input-lg" />

                                    </div>

                                </td>

                                <td>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txtfromHourNone2" style="width:65px;" type="text" value="13:00" placeholder="משעה " class="form-control input-lg" />

                                    </div>

                                    <div class="form-group floating-label-form-group controls">

                                        <input id="txttoHourNone2" style="width:65px;" type="text" value="14:00" placeholder="עד שעה" class="form-control input-lg" />

                                    </div>

                                </td>

                                

                            </tr>





                        </table>





                        <div style="float:none">

                            <div id="dvProgBar" style="text-align:center;display:none;"><img src="css/ProgressBlue.gif" /></div>

                            <div id="dvErrRegister"></div>

                            <button onClick="Register();" class="btn btn-blue">הרשמה</button>

                        </div>

                    </div>

                </div>

            </div>

        </div>

    </section>



</body>

</html>

<script>





    function Register() {



        var user = $("#name").val();

        var password = $("#password").val();

        var email = $("#email").val();

        var bizName = $("#bizName").val();

        var bizNameEng = $("#bizNameEng").val();

        var creditCard = $("#creditCard").val();

        var address = $("#address").val();

        var city = $("#city").val();

        var tel = $("#txtTel").val();



        $("#spnActiveDays").text("");



        if (user.length <= 0) {

            showTooltip("name", "נא להזין שם");

            return;

        }



        if (password.length <= 0) {

            showTooltip("password", "נא להזין סיסמה");

            return;

        }



        if (password.length < 8) {

            showTooltip("password", "נא להזין לפחות 8 תווים");

            return;

        }

        if (email.length <= 0) {

            showTooltip("email", "נא להזין מייל");

            return;

        }

        if (tel.length <= 0) {

            showTooltip("txtTel", "נא להזין מספר טלפון נייד");

            return;

        }

        if (!IsvalidEmail(email)) {

            showTooltip("email", "נא להזין מייל תקין");

            return;

        }



        if (bizName.length <= 0) {

            showTooltip("bizName", "נא להזין שם עסק");

            return;

        }



        if (bizNameEng.length <= 0) {

            showTooltip("bizNameEng", "נא להזין שם עסק באנגלית");

            return;

        }



        if (creditCard.length <= 0) {

            showTooltip("creditCard", "נא להזין כרטיס אשראי ");

            return;

        }



        if (address.length <= 0) {

            showTooltip("address", "נא להזין כתובת");

            return;

        }



        if (city == "0") {

            showTooltip("city", "נא להזין עיר");

            return;

        }


        //var bizType = BizType


        if (!NoneHours) {

            txtfromHourNone = "";

            txttoHourNone = "";

        }
        var UserActivitiesDiv = $("#UserActivities").html();
        if (UserActivitiesDiv.length == 0) {
            showTooltip("BizType", "נא להזין שם עובד");
        }

        if (isEmptyObject(ActivitiesData)) {

            showTooltip("EmployeeId", "נא להזין סוג פעילות")

            return;

        }

        
        var userObj = {

            User: user,

            Password: password,

            Email: email,

            tel: tel,

            BizName: bizName,

            BizNameEng: bizNameEng,

            Adrress: address,

            City: city,

            Country: "Israel",

            CreditCard: creditCard,

            dicBizType: ActivitiesData,
            UserActivities: ActivitiesUserData
        }



        $.ajax({

            url: "User/Register",

            type: 'POST',

            data: JSON.stringify(userObj),

            contentType: "application/json;charset=utf-8",

            success: function (data) {

                if (data.ErrorMsg == null || data.ErrorMsg == "")

                    messageHandler.Show("נשלח אליך מייל, אנא לחץ על הקישור עלמנת להתחבר למערכת.");

                else

                    messageHandler.Show(data.ErrorMsg);

            },

            error: function (request, status, error) {



            }

        });





    }



    function EnableNoneActiveHours(obj) {

        if (obj.checked) {

            $("#txtfromHourNone").removeAttr("disabled");

            $("#txttoHourNone").removeAttr("disabled");

        }

        else {

            $("#txtfromHourNone").attr("disabled", "disabled");

            $("#txttoHourNone").attr("disabled", "disabled");

        }



    }



    function init() {

        $("#txtfromHourNone").attr("disabled", "disabled");

        $("#txttoHourNone").attr("disabled", "disabled");

    }



    var ActivitiesData = {};
    var ActivitiesUserData = {};


    function GetBizTypeItem() {

        return { ActiveDay: 0, EmployeeName: "", ActiveHourFrom: "", ActiveHourTo: "", ActiveHourFromNone: "", ActiveHourToNone: "" };

    }



    function checkValid(txtId, textMsg) {

        $('#' + txtId).tooltip('hide');

        var txt = $("#" + txtId).val();

        if (txt.length <= 0) {

            //showTooltip(txtId, textMsg);

            $('#' + txtId).tooltip({

                title: textMsg

            });

            $('#' + txtId).tooltip('show');

            $('#' + txtId).focus();

            return false;

        }

        return true;

    }



    function checkValidDDl(txtId, textMsg) {

        $('#' + txtId).tooltip('hide');

        var txt = $("#" + txtId).val();

        if (txt == "0" || txt == "") {

            //showTooltip(txtId, textMsg);

            $('#' + txtId).tooltip({

                title: textMsg

            });

            $('#' + txtId).tooltip('show');

            $('#' + txtId).focus();

            return false;

        }

        return true;

    }



    function checkHour(txtId, textMsg) {

        $('#' + txtId).tooltip('hide');

        if (!isHour($("#" + txtId).val())) {

            $('#' + txtId).tooltip({

                title: textMsg

            });

            $('#' + txtId).tooltip('show');

            $('#' + txtId).focus();

            return false;

        }

        return true;

    }

    function AddActivity() {

        var data = "";

        var ActivitiesTempData = new Array();

        if (!checkValid("EmployeeId", "נא להזין שם עובד")) {

            return;

        }

        for (var i = 1; i <= 2; i++) {

            var id = i.toString();

            var Day = document.getElementById('Day' + id).checked;



            if (Day) {



                if (!checkValid("txtfromHour" + id, "נא להזין משעה")) {

                    return;

                }

                if (!checkHour("txtfromHour" + id, "שעה לא חוקית")) {

                    return;

                }

                if (!checkValid("txttoHour" + id, "נא להזין עד שעה")) {

                    return;

                }

                if (!checkHour("txttoHour" + id)) {

                    return;

                }

                



            }

            var item = GetBizTypeItem();

            item.EmployeeName = $('#EmployeeId').val();

            item.ActiveDay = id;

            //item.ActiveDuration = $('#ddlDuration' + id).val();

            item.ActiveHourFrom = $('#txtfromHour' + id).val();

            item.ActiveHourTo = $('#txttoHour' + id).val();

            item.ActiveHourFromNone = $('#txtfromHourNone' + id).val();

            item.ActiveHourToNone = $('#txttoHourNone' + id).val();



            ActivitiesTempData.push(item);

        }

        if (ActivitiesData[item.EmployeeName] == null) {

            var index = ActivitiesData.length;

            ActivitiesData[item.EmployeeName] = ActivitiesTempData;

            data = "<div style='width:100%;' id='dvBizType" + item.EmployeeName + "'><div style='float:right;width:260px;padding-right:20px;'>" + item.EmployeeName + "</div><button style='float:right;marging-right:4px;' onclick=deleteBizType('" + item.EmployeeName + "')>מחק</button></div>";

            var newDiv = $("#Activities").html();



            $("#Activities").html(newDiv + data);

            $('#EmployeeId').val("");

        }

    }



    function deleteBizType(i) {

        delete ActivitiesData[i];

        $('#dvBizType' + i).remove();

    }



    function isEmptyObject(obj) {

        for (var name in obj) {

            return false;

        }

        return true;

    }



    function Login() {

        var userObj = { Mail: "", Password: "" };

        userObj.Mail = $('#emailLogin').val();

        userObj.Password = $('#passwordLogin').val();



        $.ajax({

            url: "User/Login",

            type: 'POST',

            data: JSON.stringify(userObj),

            contentType: "application/json;charset=utf-8",

            success: function (data) {

                if (data != null) {

                    goToCal(data);

                }

                else {

                    messageHandler.Show("משתמש לא קיים");

                }

            },

            error: function (request, status, error) {

            }

        });

    }

    function RegisterCustmer() {

        var user = $("#userCust").val();

        var password = $("#passwordCustomer").val();

        var email = $("#emailCustomer").val();

        var txtTelCust = $("#txtTelCust").val();

        if (email.length <= 0) {

            showTooltip("emailCustomer", "נא להזין מייל");

            return;

        }

        if (user.length <= 0) {

            showTooltip("userCust", "נא להזין שם");

            return;

        }

        if (txtTelCust.length <= 0) {

            showTooltip("txtTelCust", "נא להזין טלפון נייד");

            return;

        }

        if (!IsvalidEmail(email)) {

            showTooltip("emailCustomer", "נא להזין מייל תקין");

            $("#emailCustomer").val("");

            return;

        }

        if (password.length <= 0) {

            showTooltip("passwordCustomer", "נא להזין סיסמה");

            return;

        }



        if (password.length < 8) {

            showTooltip("passwordCustomer", "נא להזין לפחות 8 תווים");

            $("#passwordCustomer").val("");

            return;

        }



        var userObj = {

            Name: user,

            Password: password,

            tel: txtTelCust,

            Email: email

        }

        $.ajax({

            url: "User/RegisterCustmer",

            type: 'POST',

            data: JSON.stringify(userObj),

            contentType: "application/json;charset=utf-8",

            success: function (data) {

                if (data.ErrorMsg != "")

                    messageHandler.Show("נשלח אליך מייל, אנא לחץ על הקישור עלמנת להתחבר למערכת.");

            },

            error: function (request, status, error) {



            }

        });

    }

    init();

    function goToCal(data) {

        if (data != null) {

            sessionStorage.setItem("UserData", JSON.stringify(data));

            location.href = "cal.html";

        }

    }


    function AddUserActivity() {
        
        var data = "";

        var ActivitiesTempData = new Array();
        var bizType = $('#BizType').val();
        if (bizType.length == 0) {
            showTooltip("BizType", "נא להזין שם פעילות");
            return;
        }

        if (!checkValidDDl("ddlDuration", "נא להזין משך פעילות")) {
            return;
        }
        if (ActivitiesUserData[bizType] == null) {
          
            ActivitiesUserData[bizType] = $('#ddlDuration').val();

            data = "<div style='width:100%;' id='dvBizTypeAct" + bizType + "'><div style='float:right;width:260px;padding-right:20px;'>" + bizType + " למשך  " + ActivitiesUserData[bizType] + " דקות</div><button style='float:right;marging-right:4px;' onclick=deleteBizTypeActivity('" + bizType + "')>מחק</button></div>";

            var newDiv = $("#UserActivities").html();

            $("#UserActivities").html(newDiv + data);
            $('#BizType').val("");
        }

    }
    function deleteBizTypeActivity(i) {
        delete ActivitiesUserData[i];

        $('#dvBizTypeAct' + i).remove();

    }
</script>

